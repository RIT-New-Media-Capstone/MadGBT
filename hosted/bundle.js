(()=>{var e={54:e=>{e.exports={elementDictionary:(e,t)=>{const n=t||(e=>e),s={};for(let t=0;t<e.length;t++){const r=e[t];s[r]=document.querySelector(`#${n(r)}`)}return s},setElDictItemVisible:(e,t,n)=>{e[n]&&Object.keys(e).forEach((s=>{e[s].classList.toggle(t,s===n)}))}}},924:(e,t,n)=>{const{elementDictionary:s,setElDictItemVisible:r}=n(54);let o={},i={};const a=e=>{r(i,"activeStoryImage",e)};e.exports={waitForImageWithMessage:e=>{o.waitingStoryImageMessage.innerText=e,a("waiting")},setImageSrc:e=>{o.storyImage.src=e,a("show")},showImageError:e=>{o.storyImageErrorMessage.innerText=e,a("error")},initImageManagement:()=>{o=s(["waitingStoryImageMessage","storyImage","storyImageErrorMessage"]),i=s(["waiting","show","error"],(e=>`${e}StoryImage`))}}},738:(e,t,n)=>{const{elementDictionary:s,setElDictItemVisible:r}=n(54);let o={},i={};const a=()=>{window.scrollTo(0,0)},l=e=>{r(i,"activeScreen",e),a()};e.exports={scrollToTop:a,waitWithMessage:e=>{o.waitingMessage.innerText=e,l("waiting")},promptToFillInBlanks:e=>{o.fillInBlanksFormBlanks.innerHTML=e.map(((e,t)=>`<div><label for="${t}">${e}:</label><input type="text" name="${t}"></div>`)).join(""),l("fillInBlanks")},seeResults:e=>{let t="";if(e.includes("Title:")){const n=e.indexOf("\n"),s=e.substring(e.indexOf("Title:")+7,n);console.log("title",s),t+=`<strong>${s}</strong><br>`,t+=e.substring(n,e.length-1)}else t=e;o.finishedStory.innerHTML=t,l("results")},exitWithError:e=>{o.errorMessage.innerText=e,l("start")},initScreenManagement:()=>{o=s(["errorMessage","waitingMessage","fillInBlanksFormBlanks","finishedStory"]),i=s(["start","waiting","fillInBlanks","results"],(e=>`${e}Screen`))}}}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,n),o.exports}(()=>{const{elementDictionary:e}=n(54),{scrollToTop:t,waitWithMessage:s,promptToFillInBlanks:r,seeResults:o,exitWithError:i,initScreenManagement:a}=n(738),{waitForImageWithMessage:l,setImageSrc:c,showImageError:g,initImageManagement:m}=n(924);let h,p={};const u=e=>{e.preventDefault();const n=[];let s=!0;p.fillInBlanksFormBlanks.querySelectorAll("input").forEach((e=>{const t=e.value;n.push(t),t.length>0?e.classList.remove("formMissedRequirement"):(e.classList.add("formMissedRequirement"),s=!1)})),s?h(n):t()};window.onload=async()=>{a(),m();let t,n=[];p=e(["startGameButton","fillInBlanksForm","fillInBlanksFormBlanks","playAgainButton"]),p.fillInBlanksForm.addEventListener("submit",u);const f=()=>{s("Getting Prompt..."),(async()=>{const e=await fetch("/generate-story");if(!e.ok){const t=`An error has occured: ${e.status}`;throw new Error(t)}return(await e.json()).content})().then((e=>{console.log("response",e),t=e,n=(e=>{const t=[],n=[];for(let s=0;s<e.length;s++)if("["===e[s])t.push(s);else if("]"===e[s]&&t.length>0){const r=t[t.length-1];t.pop();const o=s-1-r;let i;i=r<o?e.substring(r+1,o+1):e.substring(r+1,o+r+1),n.push(i)}return console.log("wordTypes",n),n})(e),r(n)})).catch(i)};p.startGameButton.onclick=f,p.playAgainButton.onclick=f,h=e=>{var s;o(((e,t,n)=>{let s=n;for(let n=0;n<e.length;n++)s=s.replace(`[${t[n]}]`,`<span class="filledInWord">${e[n]}</span>`);return s})(e,n,t)),l("Generating a picture for the story..."),(s=((e,t,n)=>{let s=n;for(let n=0;n<e.length;n++)s=s.replace(`[${t[n]}]`,`${e[n]}`);return s})(e,n,t),fetch("/generate-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:s})}).then((e=>e.json())).then((e=>e.url))).then(c).catch(g)}}})()})();